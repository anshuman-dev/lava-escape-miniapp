# 🧪 Base Sepolia Testnet Deployment Guide
*Hidden guide for step-by-step testnet deployment*

## 📋 Prerequisites Checklist
- [ ] MetaMask wallet installed
- [ ] Base Sepolia network added to MetaMask
- [ ] Test ETH in wallet
- [ ] Test USDC in wallet
- [ ] Remix IDE open

---

## 🏁 PHASE 1: Setup Your Wallet & Get Test Funds

### Step 1.1: Add Base Sepolia to MetaMask
1. Open MetaMask
2. Click network dropdown (top center)
3. Click "Add Network" → "Add network manually"
4. Enter these details:
   ```
   Network Name: Base Sepolia
   RPC URL: https://sepolia.base.org
   Chain ID: 84532
   Currency Symbol: ETH
   Block Explorer: https://sepolia.basescan.org
   ```
5. Click "Save"
6. Switch to Base Sepolia network

### Step 1.2: Get Base Sepolia ETH
1. Go to https://www.alchemy.com/faucets/base-sepolia
2. Connect your MetaMask wallet
3. Request 0.1 ETH (more than enough for deployment)
4. Wait 1-2 minutes for funds to arrive
5. Check balance in MetaMask (should show ~0.1 ETH)

### Step 1.3: Get Test USDC for BasePay
1. Go to https://faucet.circle.com/
2. Select "Base Sepolia" network
3. Connect your wallet
4. Request test USDC
5. Wait for confirmation

✅ **Checkpoint**: You should now have ETH and USDC on Base Sepolia

---

## 🏁 PHASE 2: Deploy Smart Contracts

### Step 2.1: Open Remix IDE
1. Go to https://remix.ethereum.org
2. Create new workspace or use default
3. You'll see the file explorer on the left

### Step 2.2: Create Contract Files
1. In file explorer, create new file: `LavaEscapeLives.sol`
2. Copy contract from `/workspaces/lava-escape-miniapp/contracts/LavaEscapeLives.sol`
3. Paste into Remix
4. Create new file: `LavaEscapeLeaderboard.sol`
5. Copy contract from `/workspaces/lava-escape-miniapp/contracts/LavaEscapeLeaderboard.sol`
6. Paste into Remix

### Step 2.3: Import OpenZeppelin Contracts
1. In Remix, go to File Explorer
2. Click "+" to create new folder: `@openzeppelin`
3. Inside that folder, create: `contracts`
4. Go to Remix's "Library" tab (plugin manager)
5. Install "OpenZeppelin Contracts" plugin
6. OR manually import by adding this line to your contracts:
   ```solidity
   import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.0/contracts/access/Ownable.sol";
   import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.0/contracts/security/ReentrancyGuard.sol";
   import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.9.0/contracts/token/ERC20/IERC20.sol";
   ```

### Step 2.4: Compile Contracts
1. Go to "Solidity Compiler" tab (2nd icon from top)
2. Set compiler version: `0.8.19` or higher
3. Enable "Optimization" with 200 runs
4. Click "Compile LavaEscapeLives.sol"
5. Click "Compile LavaEscapeLeaderboard.sol"
6. Check for green checkmarks (no errors)

### Step 2.5: Deploy LavaEscapeLives Contract
1. Go to "Deploy & Run" tab (3rd icon from top)
2. Set Environment: "Injected Provider - MetaMask"
3. Confirm MetaMask is on Base Sepolia
4. Select contract: "LavaEscapeLives"
5. Click "Deploy"
6. Confirm transaction in MetaMask
7. **SAVE THE CONTRACT ADDRESS** (copy from deployed contracts section)

### Step 2.6: Deploy LavaEscapeLeaderboard Contract
1. Select contract: "LavaEscapeLeaderboard"
2. Click "Deploy"
3. Confirm transaction in MetaMask
4. **SAVE THE CONTRACT ADDRESS**

✅ **Checkpoint**: You should have 2 deployed contracts with addresses

---

## 🏁 PHASE 3: Verify Contracts (Optional but Recommended)

### Step 3.1: Verify on Base Sepolia Explorer
1. Go to https://sepolia.basescan.org
2. Search for your LavaEscapeLives contract address
3. Click "Contract" tab
4. Click "Verify and Publish"
5. Fill in:
   - Compiler Type: Solidity (Single file)
   - Compiler Version: 0.8.19 (match what you used)
   - License Type: MIT
6. Paste your contract source code
7. Click "Verify and Publish"
8. Repeat for LavaEscapeLeaderboard

---

## 🏁 PHASE 4: Update Frontend Code

### Step 4.1: Update Contract Addresses
1. Open `/workspaces/lava-escape-miniapp/index.html`
2. Find this section (around line 520):
   ```javascript
   const CONTRACTS = {
       LIVES: '0x0000000000000000000000000000000000000000', // Placeholder
       LEADERBOARD: '0x0000000000000000000000000000000000000000' // Placeholder
   };
   ```
3. Replace with your deployed addresses:
   ```javascript
   const CONTRACTS = {
       LIVES: '0xYOUR_LIVES_CONTRACT_ADDRESS',
       LEADERBOARD: '0xYOUR_LEADERBOARD_CONTRACT_ADDRESS'
   };
   ```

### Step 4.2: Update BasePay Settings
1. Find the `buyLivesWithBasePay` function (around line 1362)
2. Update the recipient address:
   ```javascript
   to: '0xYOUR_WALLET_ADDRESS', // Your deployer wallet
   ```
3. Confirm `testnet: true` is set

### Step 4.3: Update Network Configuration
1. Find the wagmi config (around line 530)
2. Ensure it's set to Base Sepolia for testing

---

## 🏁 PHASE 5: Test Everything

### Step 5.1: Test Local Game
1. Open your game in browser (serve index.html)
2. Connect MetaMask wallet
3. Check lives display shows "3"
4. Play a game and lose a life

### Step 5.2: Test ETH Purchase
1. Click "Buy Lives" when out of lives
2. Try "1 Life - 0.0001 ETH" button
3. Confirm MetaMask transaction
4. Wait for confirmation
5. Check lives updated

### Step 5.3: Test BasePay Purchase
1. Click "⚡ 1 Life - BasePay ($0.30)" button
2. Follow BasePay payment flow
3. Confirm payment
4. Check lives updated

### Step 5.4: Test Leaderboard
1. Play game and get a score > 5 jumps
2. Submit score when game ends
3. Click "🏆 Leaderboard" button
4. Verify your score appears

✅ **Checkpoint**: All features working on testnet!

---

## 🏁 PHASE 6: Deploy to Staging

### Step 6.1: Commit Changes
```bash
git add .
git commit -m "Update contract addresses for testnet deployment"
git push
```

### Step 6.2: Test Live Version
1. Visit your Netlify URL
2. Test all functions work live
3. Check Farcaster Frame preview

---

## 🎯 What to Record for Mainnet

When everything works on testnet, save these for mainnet deployment:

```
✅ TESTNET SUCCESS RECORD
Lives Contract: 0xYOUR_LIVES_ADDRESS
Leaderboard Contract: 0xYOUR_LEADERBOARD_ADDRESS
Deployer Wallet: 0xYOUR_WALLET_ADDRESS
Total Gas Used: ~X ETH
BasePay Working: ✅
All Functions Tested: ✅
Ready for Mainnet: ✅
```

---

## 🚨 Troubleshooting

**Contract deployment fails:**
- Check you have enough ETH (need ~0.01 ETH)
- Verify Base Sepolia network selected
- Try increasing gas limit

**BasePay not working:**
- Ensure you have test USDC
- Check testnet: true is set
- Verify recipient address is correct

**Transactions failing:**
- Check contract addresses are correct
- Verify network is Base Sepolia
- Try refreshing page and reconnecting wallet

**Functions not found:**
- Ensure contracts compiled without errors
- Check OpenZeppelin imports work
- Verify contract addresses copied correctly

---

*This guide will get you through testnet deployment step by step. Once successful, we'll do the same process for mainnet!* 🚀